<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LCTA - 边狱公司汉化工具箱</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background-color: #f0f0f0;
            height: 100vh;
            display: flex;
        }

        .sidebar {
            width: 220px;
            background-color: #2c3e50;
            color: white;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .sidebar h2 {
            text-align: center;
            margin-bottom: 30px;
            padding: 0 10px;
            font-size: 18px;
        }

        .sidebar button {
            background: none;
            border: none;
            color: white;
            padding: 12px 20px;
            text-align: left;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
            border-left: 4px solid transparent;
        }

        .sidebar button:hover {
            background-color: #34495e;
        }

        .sidebar button.active {
            background-color: #3498db;
            border-left: 4px solid #2980b9;
        }

        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .content-section {
            display: none;
            flex: 1;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .content-section.active {
            display: block;
        }

        .section-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #2c3e50;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #34495e;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            font-weight: normal;
        }

        .checkbox-label input {
            width: auto;
            margin-right: 8px;
        }

        input, select, textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .file-input-group {
            display: flex;
            gap: 10px;
        }

        .file-input-group input {
            flex: 1;
        }

        button.submit-btn, button.action-btn {
            background-color: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        button.submit-btn:hover, button.action-btn:hover {
            background-color: #2980b9;
        }

        button.secondary-btn {
            background-color: #95a5a6;
        }

        button.secondary-btn:hover {
            background-color: #7f8c8d;
        }

        .log-container {
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f8f9fa;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 13px;
            flex: 1;
            min-height: 200px;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
            border-bottom: 1px solid #eee;
        }

        .log-timestamp {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .log-message {
            color: #2c3e50;
        }

        .progress-container {
            margin: 20px 0;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background-color: #2ecc71;
            width: 0%;
            transition: width 0.3s;
        }

        .progress-text {
            text-align: center;
            margin-top: 5px;
            font-weight: bold;
        }

        .hidden {
            display: none;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .card h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 1px solid #ecf0f1;
            padding-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>LCTA v3.1.0</h2>
        <button id="translate-btn" class="active">翻译工具</button>
        <button id="install-btn">安装已有汉化</button>
        <button id="ourplay-btn">从ourplay下载汉化</button>
        <button id="clean-btn">清除本地缓存</button>
        <button id="llc-btn">从零协下载汉化</button>
        <button id="config-btn">配置汉化api</button>
        <button id="proper-btn">抓取专有词汇</button>
        <button id="search-btn">进行文本搜索</button>
        <button id="backup-btn">备份原文</button>
        <button id="assets-btn">资源管理</button>
        <button id="lighter-btn">黑影图调色</button>
        <button id="calculate-btn">抽卡概率计算</button>
        <button id="about-btn">关于</button>
    </div>

    <div class="main-content">
        <!-- 翻译工具界面 -->
        <div id="translate-section" class="content-section active">
            <h2 class="section-title">翻译工具</h2>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="custom-script"> 使用自定义翻译脚本
                </label>
            </div>
            
            <div class="form-group" id="script-path-group" style="display: none;">
                <label for="script-path">脚本路径:</label>
                <div class="file-input-group">
                    <input type="text" id="script-path" placeholder="选择自定义脚本文件">
                    <button class="action-btn" onclick="browseFile('script-path')">浏览</button>
                </div>
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="cache-trans"> 启用翻译缓存
                </label>
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="team-trans"> 团队翻译模式
                </label>
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="excel-output"> 输出至Excel文件
                </label>
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="log-enabled" checked> 启用日志
                </label>
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="half-trans"> 使用翻译至一半的项目
                </label>
            </div>
            
            <div class="form-group" id="half-trans-path-group" style="display: none;">
                <label for="half-trans-path">项目路径:</label>
                <div class="file-input-group">
                    <input type="text" id="half-trans-path" placeholder="选择半翻译项目路径">
                    <button class="action-btn" onclick="browseFile('half-trans-path')">浏览</button>
                </div>
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="backup"> 使用上版本备份原文
                </label>
            </div>
            
            <div class="form-group" id="backup-path-group" style="display: none;">
                <label for="backup-path">备份路径:</label>
                <div class="file-input-group">
                    <input type="text" id="backup-path" placeholder="选择备份文件路径">
                    <button class="action-btn" onclick="browseFile('backup-path')">浏览</button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="translation-service">翻译服务:</label>
                <select id="translation-service">
                    <option value="baidu">百度翻译</option>
                    <option value="tencent">腾讯翻译</option>
                    <option value="youdao">有道翻译</option>
                    <option value="caiyun">彩云翻译</option>
                    <option value="xiaoniu">小牛翻译</option>
                    <option value="aliyun">阿里云翻译</option>
                    <option value="huoshan">火山翻译</option>
                    <option value="chatgpt">ChatGPT翻译</option>
                </select>
            </div>
            
            <button class="submit-btn" onclick="startTranslation()">开始翻译</button>
            
            <div class="progress-container" id="translation-progress">
                <div class="progress-bar">
                    <div class="progress-bar-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text" id="progress-text">0%</div>
            </div>
        </div>

        <!-- 安装汉化界面 -->
        <div id="install-section" class="content-section">
            <h2 class="section-title">安装已有汉化</h2>
            <div class="form-group">
                <label for="install-package">汉化包文件:</label>
                <div class="file-input-group">
                    <input type="text" id="install-package" placeholder="选择汉化包文件 (.zip)">
                    <button class="action-btn" onclick="browseFile('install-package')">浏览</button>
                </div>
            </div>
            <div class="form-group">
                <label for="install-path">游戏路径:</label>
                <div class="file-input-group">
                    <input type="text" id="install-path" placeholder="游戏安装路径">
                    <button class="action-btn" onclick="browseFolder('install-path')">浏览</button>
                </div>
            </div>
            <button class="submit-btn" onclick="installTranslation()">安装汉化</button>
        </div>

        <!-- OurPlay下载界面 -->
        <div id="ourplay-section" class="content-section">
            <h2 class="section-title">从ourplay下载汉化</h2>
            <p>点击下方按钮开始从OurPlay下载最新的汉化包。</p>
            <button class="submit-btn" onclick="downloadOurplay()">下载OurPlay汉化包</button>
        </div>

        <!-- 清除缓存界面 -->
        <div id="clean-section" class="content-section">
            <h2 class="section-title">清除本地缓存</h2>
            <p>此功能将清除本地的翻译缓存文件，释放磁盘空间。</p>
            <button class="submit-btn secondary-btn" onclick="cleanCache()">清除缓存</button>
        </div>

        <!-- 零协下载界面 -->
        <div id="llc-section" class="content-section">
            <h2 class="section-title">从零协下载汉化</h2>
            <p>下载零协汉化组提供的汉化包。</p>
            <button class="submit-btn" onclick="downloadLLC()">下载零协汉化包</button>
        </div>

        <!-- 配置API界面 -->
        <div id="config-section" class="content-section">
            <h2 class="section-title">配置汉化API</h2>
            <div class="form-group">
                <label for="api-service">选择翻译服务:</label>
                <select id="api-service">
                    <option value="baidu">百度翻译</option>
                    <option value="tencent">腾讯翻译</option>
                    <option value="youdao">有道翻译</option>
                    <option value="caiyun">彩云翻译</option>
                    <option value="xiaoniu">小牛翻译</option>
                    <option value="aliyun">阿里云翻译</option>
                    <option value="huoshan">火山翻译</option>
                    <option value="chatgpt">ChatGPT翻译</option>
                </select>
            </div>
            <div class="form-group">
                <label for="api-key">API密钥:</label>
                <input type="password" id="api-key" placeholder="输入API密钥">
            </div>
            <div class="form-group">
                <label for="api-secret">密钥密文 (如需要):</label>
                <input type="password" id="api-secret" placeholder="输入密钥密文">
            </div>
            <button class="submit-btn" onclick="saveAPIConfig()">保存配置</button>
        </div>

        <!-- 专有词汇界面 -->
        <div id="proper-section" class="content-section">
            <h2 class="section-title">抓取专有词汇</h2>
            <div class="form-group">
                <label for="proper-output">输出格式:</label>
                <select id="proper-output">
                    <option value="json">JSON格式</option>
                    <option value="single">单文件格式</option>
                    <option value="double">双文件格式</option>
                </select>
            </div>
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="proper-skip-space"> 跳过含空格的词汇
                </label>
            </div>
            <div class="form-group">
                <label for="proper-max-count">最大词汇数量 (留空表示无限制):</label>
                <input type="number" id="proper-max-count" placeholder="例如：100">
            </div>
            <button class="submit-btn" onclick="fetchProperNouns()">抓取专有词汇</button>
        </div>

        <!-- 文本搜索界面 -->
        <div id="search-section" class="content-section">
            <h2 class="section-title">进行文本搜索</h2>
            <div class="form-group">
                <label for="search-keyword">搜索关键词:</label>
                <input type="text" id="search-keyword" placeholder="输入要搜索的文本">
            </div>
            <div class="form-group">
                <label for="search-path">搜索路径:</label>
                <div class="file-input-group">
                    <input type="text" id="search-path" placeholder="留空则搜索整个游戏目录">
                    <button class="action-btn" onclick="browseFolder('search-path')">浏览</button>
                </div>
            </div>
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="search-case-sensitive"> 区分大小写
                </label>
            </div>
            <button class="submit-btn" onclick="searchText()">开始搜索</button>
            
            <div id="search-results" class="log-container" style="margin-top: 20px; height: 300px;">
                <div class="log-entry">
                    <span class="log-timestamp">[提示]</span>
                    <span class="log-message">搜索结果将显示在这里</span>
                </div>
            </div>
        </div>

        <!-- 备份原文界面 -->
        <div id="backup-section" class="content-section">
            <h2 class="section-title">备份原文</h2>
            <div class="form-group">
                <label for="backup-source">源文件路径:</label>
                <div class="file-input-group">
                    <input type="text" id="backup-source" placeholder="选择要备份的原文文件或目录">
                    <button class="action-btn" onclick="browseFile('backup-source')">浏览</button>
                </div>
            </div>
            <div class="form-group">
                <label for="backup-destination">备份保存路径:</label>
                <div class="file-input-group">
                    <input type="text" id="backup-destination" placeholder="选择备份保存位置">
                    <button class="action-btn" onclick="browseFolder('backup-destination')">浏览</button>
                </div>
            </div>
            <button class="submit-btn" onclick="backupText()">开始备份</button>
        </div>

        <!-- 资源管理界面 -->
        <div id="assets-section" class="content-section">
            <h2 class="section-title">资源管理</h2>
            <p>管理游戏资源文件</p>
            <div class="grid-container">
                <div class="card">
                    <h3>字体管理</h3>
                    <p>管理游戏字体资源</p>
                    <button class="action-btn" onclick="manageFonts()">管理字体</button>
                </div>
                <div class="card">
                    <h3>图片资源</h3>
                    <p>管理游戏图片资源</p>
                    <button class="action-btn" onclick="manageImages()">管理图片</button>
                </div>
                <div class="card">
                    <h3>音频资源</h3>
                    <p>管理游戏音频资源</p>
                    <button class="action-btn" onclick="manageAudio()">管理音频</button>
                </div>
            </div>
        </div>

        <!-- 黑影图调色界面 -->
        <div id="lighter-section" class="content-section">
            <h2 class="section-title">黑影图调色</h2>
            <p>调整游戏图片亮度和对比度</p>
            <div class="form-group">
                <label for="image-path">选择图片:</label>
                <div class="file-input-group">
                    <input type="text" id="image-path" placeholder="选择要调整的图片文件">
                    <button class="action-btn" onclick="browseFile('image-path')">浏览</button>
                </div>
            </div>
            <div class="form-group">
                <label for="brightness">亮度: <span id="brightness-value">0</span></label>
                <input type="range" id="brightness" min="-100" max="100" value="0" oninput="updateValue('brightness')">
            </div>
            <div class="form-group">
                <label for="contrast">对比度: <span id="contrast-value">0</span></label>
                <input type="range" id="contrast" min="-100" max="100" value="0" oninput="updateValue('contrast')">
            </div>
            <button class="submit-btn" onclick="adjustImage()">调整图片</button>
        </div>

        <!-- 抽卡概率计算界面 -->
        <div id="calculate-section" class="content-section">
            <h2 class="section-title">抽卡概率计算</h2>
            <p>计算游戏抽卡系统相关概率</p>
            <div class="form-group">
                <label for="total-items">总物品数:</label>
                <input type="number" id="total-items" value="100" min="1">
            </div>
            <div class="form-group">
                <label for="rare-items">稀有物品数:</label>
                <input type="number" id="rare-items" value="5" min="1">
            </div>
            <div class="form-group">
                <label for="draw-count">抽取次数:</label>
                <input type="number" id="draw-count" value="10" min="1">
            </div>
            <button class="submit-btn" onclick="calculateGacha()">计算概率</button>
            
            <div id="calculation-results" class="log-container" style="margin-top: 20px; height: 200px;">
                <div class="log-entry">
                    <span class="log-timestamp">[结果]</span>
                    <span class="log-message">计算结果将显示在这里</span>
                </div>
            </div>
        </div>

        <!-- 关于界面 -->
        <div id="about-section" class="content-section">
            <h2 class="section-title">关于 LCTA</h2>
            <div class="card">
                <h3>LCTA - 边狱公司汉化工具箱</h3>
                <p><strong>版本:</strong> 3.1.0</p>
                <p><strong>描述:</strong> 一个用于自动翻译《边狱公司》游戏内容的工具，支持多种翻译API和汉化包管理。</p>
                <p><strong>功能:</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>自动翻译游戏文本</li>
                    <li>支持多种翻译API</li>
                    <li>汉化包安装与管理</li>
                    <li>从多个来源下载汉化</li>
                    <li>文本搜索与备份</li>
                    <li>丰富的辅助工具</li>
                </ul>
            </div>
        </div>

        <!-- 底部日志区域 -->
        <div id="log-area" class="log-container">
            <div class="log-entry">
                <span class="log-timestamp">[2025-01-01 12:00:00]</span>
                <span class="log-message">系统已启动，准备就绪</span>
            </div>
        </div>
    </div>

    <script>
        // 切换侧边栏按钮激活状态
        document.querySelectorAll('.sidebar button').forEach(button => {
            button.addEventListener('click', () => {
                // 移除所有按钮的active类
                document.querySelectorAll('.sidebar button').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // 添加active类到当前按钮
                button.classList.add('active');
                
                // 隐藏所有内容区域
                document.querySelectorAll('.content-section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // 显示对应的内容区域
                const sectionId = button.id.replace('-btn', '-section');
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.add('active');
                }
            });
        });

        // 复选框逻辑
        document.getElementById('custom-script').addEventListener('change', function() {
            const group = document.getElementById('script-path-group');
            group.style.display = this.checked ? 'block' : 'none';
        });

        document.getElementById('half-trans').addEventListener('change', function() {
            const group = document.getElementById('half-trans-path-group');
            group.style.display = this.checked ? 'block' : 'none';
        });

        document.getElementById('backup').addEventListener('change', function() {
            const group = document.getElementById('backup-path-group');
            group.style.display = this.checked ? 'block' : 'none';
        });

        // 浏览文件函数
        function browseFile(inputId) {
            pywebview.api.browse_file(inputId);
        }

        function browseFolder(inputId) {
            pywebview.api.browse_folder(inputId);
        }

        // 各功能函数
        function startTranslation() {
            // 显示进度条
            document.getElementById('translation-progress').style.display = 'block';
            // 更新进度到20%
            updateProgress(20, '开始翻译...');
            
            pywebview.api.start_translation();
        }

        function installTranslation() {
            pywebview.api.install_translation().then(function(result) {
                if (result.success) {
                    addLogMessage('汉化包安装成功: ' + result.message);
                } else {
                    addLogMessage('汉化包安装失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('安装过程中出现错误: ' + error);
            });
        }

        function downloadOurplay() {
            addLogMessage('开始下载OurPlay汉化包...');
            pywebview.api.download_ourplay_translation().then(function(result) {
                if (result.success) {
                    addLogMessage('OurPlay汉化包下载成功: ' + result.message);
                } else {
                    addLogMessage('OurPlay汉化包下载失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('下载OurPlay汉化包时出现错误: ' + error);
            });
        }

        function cleanCache() {
            if (confirm('确定要清除本地缓存吗？此操作不可撤销。')) {
                pywebview.api.clean_cache().then(function(result) {
                    if (result.success) {
                        addLogMessage('缓存清除成功: ' + result.message);
                    } else {
                        addLogMessage('缓存清除失败: ' + result.message);
                    }
                }).catch(function(error) {
                    addLogMessage('清除缓存时出现错误: ' + error);
                });
            }
        }

        function downloadLLC() {
            addLogMessage('开始下载零协汉化包...');
            pywebview.api.download_llc_translation().then(function(result) {
                if (result.success) {
                    addLogMessage('零协汉化包下载成功: ' + result.message);
                } else {
                    addLogMessage('零协汉化包下载失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('下载零协汉化包时出现错误: ' + error);
            });
        }

        function saveAPIConfig() {
            pywebview.api.save_api_config().then(function(result) {
                if (result.success) {
                    addLogMessage('API配置保存成功: ' + result.message);
                } else {
                    addLogMessage('API配置保存失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('保存API配置时出现错误: ' + error);
            });
        }

        function fetchProperNouns() {
            pywebview.api.fetch_proper_nouns().then(function(result) {
                if (result.success) {
                    addLogMessage('专有词汇抓取成功: ' + result.message);
                } else {
                    addLogMessage('专有词汇抓取失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('抓取专有词汇时出现错误: ' + error);
            });
        }

        function searchText() {
            pywebview.api.search_text().then(function(result) {
                if (result.success) {
                    addLogMessage('文本搜索完成: ' + result.message);
                    if (result.results) {
                        result.results.forEach(function(r) {
                            addLogMessage(`  文件: ${r.file}, 行: ${r.line}, 内容: ${r.content}`);
                        });
                    }
                } else {
                    addLogMessage('文本搜索失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('搜索文本时出现错误: ' + error);
            });
        }

        function backupText() {
            pywebview.api.backup_text().then(function(result) {
                if (result.success) {
                    addLogMessage('备份完成: ' + result.message);
                } else {
                    addLogMessage('备份失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('备份文本时出现错误: ' + error);
            });
        }

        function manageFonts() {
            pywebview.api.manage_fonts().then(function(result) {
                if (result.success) {
                    addLogMessage('字体管理: ' + result.message);
                } else {
                    addLogMessage('字体管理失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('字体管理时出现错误: ' + error);
            });
        }

        function manageImages() {
            pywebview.api.manage_images().then(function(result) {
                if (result.success) {
                    addLogMessage('图片管理: ' + result.message);
                } else {
                    addLogMessage('图片管理失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('图片管理时出现错误: ' + error);
            });
        }

        function manageAudio() {
            pywebview.api.manage_audio().then(function(result) {
                if (result.success) {
                    addLogMessage('音频管理: ' + result.message);
                } else {
                    addLogMessage('音频管理失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('音频管理时出现错误: ' + error);
            });
        }

        function adjustImage() {
            pywebview.api.adjust_image().then(function(result) {
                if (result.success) {
                    addLogMessage('图片调整: ' + result.message);
                } else {
                    addLogMessage('图片调整失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('调整图片时出现错误: ' + error);
            });
        }

        function calculateGacha() {
            pywebview.api.calculate_gacha().then(function(result) {
                if (result.success) {
                    addLogMessage('抽卡概率计算: ' + result.message);
                    
                    // 更新计算结果区域
                    const resultsDiv = document.getElementById('calculation-results');
                    resultsDiv.innerHTML = '';
                    const resultEntry = document.createElement('div');
                    resultEntry.className = 'log-entry';
                    resultEntry.innerHTML = `<span class="log-timestamp">[概率结果]</span> <span class="log-message">${result.message}</span>`;
                    resultsDiv.appendChild(resultEntry);
                } else {
                    addLogMessage('概率计算失败: ' + result.message);
                }
            }).catch(function(error) {
                addLogMessage('计算抽卡概率时出现错误: ' + error);
            });
        }

        function updateValue(sliderId) {
            const slider = document.getElementById(sliderId);
            const valueSpan = document.getElementById(sliderId + '-value');
            valueSpan.textContent = slider.value;
        }

        // 更新进度条函数
        function updateProgress(percent, text) {
            document.getElementById('progress-fill').style.width = percent + '%';
            document.getElementById('progress-text').textContent = text || percent + '%';
        }

        // 添加日志消息
        function addLogMessage(message) {
            const logArea = document.getElementById('log-area');
            const now = new Date();
            const timestamp = `[${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}:${String(now.getSeconds()).padStart(2, '0')}]`;
            
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.innerHTML = `<span class="log-timestamp">${timestamp}</span> <span class="log-message">${message}</span>`;
            
            logArea.appendChild(logEntry);
            logArea.scrollTop = logArea.scrollHeight;
        }

        // 从Python后端接收日志消息
        window.addEventListener('pywebviewready', function() {
            addLogMessage('WebUI已准备就绪');
            console.log('PyWebview API is ready');
        });
    </script>
</body>
</html>